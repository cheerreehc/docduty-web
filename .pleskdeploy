#!/bin/bash

echo "üîß Starting deploy in docduty.app folder..."

# 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependency (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ node_modules)
[ -d node_modules ] || npm install

# 2. Build static export
npm run build

# 3. ‡∏•‡∏ö‡πÑ‡∏ü‡∏•‡πå/‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏Å‡πà‡∏≤‡∏¢‡∏Å‡πÄ‡∏ß‡πâ‡∏ô .well-known ‡πÅ‡∏•‡∏∞ node_modules
find . -mindepth 1 -maxdepth 1 ! -name 'out' ! -name '.well-known' ! -name 'node_modules' ! -name '.git' ! -name '.pleskdeploy' -exec rm -rf {} +

# 4. ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å out/* ‡∏°‡∏≤‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà root
cp -r out/* .

# 5. ‡∏•‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå out
rm -rf out

echo "‚úÖ Deploy completed successfully!"
